id: accountstack-demo
name: AccountStack Financial Platform
summary: Full-stack financial platform (web + 3 Go APIs in monorepo)
details: |
  AccountStack is a complete account management platform demo showcasing:
  - React web application with reactive feature management (SSE)
  - 3 Go microservices (accounts, transactions, insights)
  - CloudBees CI/CD workflows with monorepo structure
  - Helm-based Kubernetes deployment
  - 9 feature flags with real-time updates
  - Path-based multi-tenant routing

  This scenario automatically creates:
  - GitHub repository (forked from CB-AccountStack/AccountStack)
  - CloudBees component
  - CloudBees environment with FM_TOKEN variable
  - CloudBees application linking component and environment

  REQUIRED: KUBECONFIG secret must exist at organization level
  The scenario will prompt you to create it if missing.

  After setup completes, manually trigger the deploy-simple workflow to deploy.
  The application will be available at:
  https://accountstack.se-main-demo.sa-demo.beescloud.com/{org}/{environment}

parameter_schema:
  properties:
    project_name:
      type: string
      description: Project name (used for repo, component, and application)
      placeholder: accountstack
      pattern: "^[a-z0-9-]+$"
    target_org:
      type: string
      description: GitHub organization for repository
      placeholder: CB-AccountStack
      pattern: "^[a-zA-Z0-9-]+$"
    environment:
      type: string
      description: Deployment environment name
      enum: ["dev", "staging", "prod"]
      default: dev
  required:
    - project_name
    - target_org
    - environment

required_secrets:
  - KUBECONFIG

repositories:
  - source: CB-AccountStack/AccountStack
    target_org: "${target_org}"
    repo_name_template: "${project_name}"
    create_component: true

environments:
  - name: "${project_name}-${environment}"
    env:
      - name: ENVIRONMENT
        value: "${environment}"
      - name: PROJECT_NAME
        value: "${project_name}"
    create_fm_token_var: true

applications:
  - name: "${project_name}-app"
    components:
      - "${project_name}"
    environments:
      - "${project_name}-${environment}"
